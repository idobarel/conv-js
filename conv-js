#!/usr/bin/env python3
from termcolor import colored
from argparse import ArgumentParser
from os import system, unlink
import base64

filedata = """Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwpjb25zdCBmID0gcHJvY2Vzcy5hcmd2WzJdOwpsZXQgZCA9ICIiOwp0cnkgewogICAgZCA9IGZzLnJlYWRGaWxlU3luYyhmLCAndXRmOCcpOwp9IGNhdGNoIChlcnIpIHsKICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKfQpjb25zdCB6ZXJvID0gJytbXSc7CmNvbnN0IG9uZSA9ICcrISFbXSc7CmNvbnN0IG51bWJlciA9IG4gPT4gewogICAgaWYgKG4gPT09IDApIHJldHVybiB6ZXJvOwogICAgcmV0dXJuIEFycmF5LmZyb20oewogICAgICAgIGxlbmd0aDogbgogICAgfSwgKCkgPT4gb25lKS5qb2luKCcgKyAnKTsKfTsKY29uc3QgbWFwID0ge307CmNvbnN0IGZyb21TdHJpbmcgPSBzID0+IHMuc3BsaXQoJycpLm1hcCh4ID0+IHsKICAgIGlmICghKHggaW4gbWFwKSkgewogICAgICAgIGNvbnN0IGNoYXJDb2RlID0geC5jaGFyQ29kZUF0KDApOwogICAgICAgIHJldHVybiBgKFtdK1tdKVske2Zyb21TdHJpbmcoJ2NvbnN0cnVjdG9yJyl9XVske2Zyb21TdHJpbmcoJ2Zyb21DaGFyQ29kZScpfV0oJHtudW1iZXIoY2hhckNvZGUpfSlgOwogICAgfQogICAgcmV0dXJuIG1hcFt4XTsKfSkuam9pbignKycpOwptYXAuYSA9IGAoK3t9K1tdKVske251bWJlcigxKX1dYDsKbWFwLmIgPSBgKHt9K1tdKVske251bWJlcigyKX1dYDsKbWFwLm8gPSBgKHt9K1tdKVske251bWJlcigxKX1dYDsKbWFwLmUgPSBgKHt9K1tdKVske251bWJlcig0KX1dYDsKbWFwLmMgPSBgKHt9K1tdKVske251bWJlcig1KX1dYDsKbWFwLnQgPSBgKHt9K1tdKVske251bWJlcig2KX1dYDsKbWFwWycgJ10gPSBgKHt9K1tdKVske251bWJlcig3KX1dYDsKbWFwLmYgPSBgKCFbXStbXSlbJHtudW1iZXIoMCl9XWA7Cm1hcC5zID0gYCghW10rW10pWyR7bnVtYmVyKDMpfV1gOwptYXAuciA9IGAoISFbXStbXSlbJHtudW1iZXIoMSl9XWA7Cm1hcC51ID0gYCghIVtdK1tdKVske251bWJlcigyKX1dYDsKbWFwLmkgPSBgKCgrISFbXS8rW10pK1tdKVske251bWJlcigzKX1dYDsKbWFwLm4gPSBgKCgrISFbXS8rW10pK1tdKVske251bWJlcig0KX1dYDsKbWFwLlMgPSBgKFtdKyhbXStbXSlbJHtmcm9tU3RyaW5nKCdjb25zdHJ1Y3RvcicpfV0pWyR7bnVtYmVyKDkpfV1gOwptYXAuZyA9IGAoW10rKFtdK1tdKVske2Zyb21TdHJpbmcoJ2NvbnN0cnVjdG9yJyl9XSlbJHtudW1iZXIoMTQpfV1gOwptYXAucCA9IGAoW10rKC8tLylbJHtmcm9tU3RyaW5nKCdjb25zdHJ1Y3RvcicpfV0pWyR7bnVtYmVyKDE0KX1dYDsKbWFwWydcXCddID0gYCgvXFxcXC8rW10pWyR7bnVtYmVyKDEpfV1gOwptYXAuZCA9IGAoJHtudW1iZXIoMTMpfSlbJHtmcm9tU3RyaW5nKCd0b1N0cmluZycpfV0oJHtudW1iZXIoMTQpfSlgOwptYXAuaCA9IGAoJHtudW1iZXIoMTcpfSlbJHtmcm9tU3RyaW5nKCd0b1N0cmluZycpfV0oJHtudW1iZXIoMTgpfSlgOwptYXAubSA9IGAoJHtudW1iZXIoMjIpfSlbJHtmcm9tU3RyaW5nKCd0b1N0cmluZycpfV0oJHtudW1iZXIoMjMpfSlgOwptYXAuQyA9IGAoKCgpPT57fSlbJHtmcm9tU3RyaW5nKCdjb25zdHJ1Y3RvcicpfV0oJHtmcm9tU3RyaW5nKCdyZXR1cm4gZXNjYXBlJyl9KSgpKCR7bWFwWydcXCddfSkpWyR7bnVtYmVyKDIpfV1gOwpjb25zdCBjb21waWxlID0gY29kZSA9PiBgKCgpPT57fSlbJHtmcm9tU3RyaW5nKCdjb25zdHJ1Y3RvcicpfV0oJHtmcm9tU3RyaW5nKGNvZGUpfSkoKWA7CmNvbnNvbGUubG9nKGNvbXBpbGUoZCkpOw=="""

def getArgs():
    parser = ArgumentParser("conv-js", description="Convert regular JS files into an unreadable format.")
    parser.add_argument("file", type=str, help="Specify the file you want to encode.")
    parser.add_argument("-o", "--output" ,type=str, required=False, dest="output", help="Specify the output filename. default is out.js", default="out.js")
    return parser.parse_args()

def createFile():
    with open('tmp.js', "wb") as f:
        f.write(base64.b64decode(filedata))
        f.close()
    

def main():
    args = getArgs()
    colored("Starting process", "green")
    createFile()
    system(f'node tmp.js "{args.file}" > {args.output}')
    unlink("tmp.js")
    print(colored("Done!", "green"))


if __name__ == '__main__':
    main()
